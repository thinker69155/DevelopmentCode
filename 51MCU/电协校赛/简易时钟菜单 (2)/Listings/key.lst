C51 COMPILER V9.59.0.0   KEY                                                               11/11/2025 09:48:49 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE KEY
OBJECT MODULE PLACED IN .\Objects\key.obj
COMPILER INVOKED BY: D:\software\keil\C51\BIN\C51.EXE key.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings
                    -\key.lst) TABS(2) OBJECT(.\Objects\key.obj)

line level    source

   1          #include <REGX52.H>
   2          //#include "delay.h"
   3          //按键匹配功能
   4          sbit Key1 = P3^0;  // 模式切换
   5          sbit Key2 = P3^1;  // 设置/确认
   6          sbit Key3 = P3^2;  // 加
   7          sbit Key4 = P3^3;  // 减
   8          
   9          
  10          
  11          void dela(unsigned int ms) 
  12            {
  13   1          unsigned int i, j;
  14   1          for(i=0; i<ms; i++)
  15   1              for(j=0; j<112; j++);
  16   1      }
  17            
  18          
  19          
  20          // 按键扫描函数：返回键值（0=无按键，1=Key1，2=Key2，3=Key3，4=Key4）
  21          unsigned char key_scan(void) {
  22   1          unsigned char key_val = 0;  // 初始化为无按键
  23   1          
  24   1          // 检测Key1（模式切换）
  25   1          if(Key1 == 0) {
  26   2              dela(20);  // 消抖（需确保delay_ms函数已实现）
  27   2              if(Key1 == 0) {
  28   3                  key_val = 1;  // 返回键值1
  29   3                  while(Key1 == 0);  // 等待按键释放
  30   3              }
  31   2          }
  32   1          // 检测Key2（确认/启动/暂停）
  33   1          else if(Key2 == 0) {
  34   2              dela(20);
  35   2              if(Key2 == 0) {
  36   3                  key_val = 2;  // 返回键值2
  37   3                  while(Key2 == 0);
  38   3              }
  39   2          }
  40   1          // 检测Key3（加/上一条）
  41   1          else if(Key3 == 0) {
  42   2              dela(20);
  43   2              if(Key3 == 0) {
  44   3                  key_val = 3;  // 返回键值3
  45   3                  while(Key3 == 0);
  46   3              }
  47   2          }
  48   1          // 检测Key4（减/下一条）
  49   1          else if(Key4 == 0) {
  50   2              dela(20);
  51   2              if(Key4 == 0) {
  52   3                  key_val = 4;  // 返回键值4
  53   3                  while(Key4 == 0);
  54   3              }
C51 COMPILER V9.59.0.0   KEY                                                               11/11/2025 09:48:49 PAGE 2   

  55   2          }
  56   1          
  57   1          return key_val;  // 返回键值（无按键返回0）
  58   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    105    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
